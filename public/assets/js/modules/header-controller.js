/*! ledvance-2019 1.3.1-95 17-11-2020 17:11:20 */
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}define(["headerModel","headerViewDefault","headerViewDesktop","headerSequencer","headerSearch","responsiveHelper"],function(a,b,c,d,e,f){"use strict";var g={default:["xs","sm","md","lg"],desktop:["xl"]},h=function b(){_classCallCheck(this,b),this.currentStage=null,this.currentView=null,this.currentLevel=null,this.previousLink=null,this.view=null,this.model=new a,this.invokeOpenFlyoutOnViewChange=!1};return h.prototype={constructor:h,init:function(a){var b=this;f.registerHandler(),f.events.on("mq_change",function(){b.currentStage=this,b.initView(a),b.initAnchorLink(),"desktop"==b.currentView&&document.querySelector(".m-flyout-backdrop").classList.contains("in")&&document.querySelector(".m-flyout-backdrop").classList.toggle("in")}),f.getStage().then(function(c){b.currentStage=c,b.initView(a),b.initAnchorLink()})},initAnchorLink:function(){var a=window.location.hash;-1!==a.indexOf("#")&&requirejs(["anchor-link"],function(a){var b=document.querySelector("".concat(window.location.hash));null!==b&&a.scrollTo(b,300)})},initView:function(a){var f=this;this.hasViewChanged()&&(this.currentView&&this.view.reset(),this.view=-1===g.default.indexOf(this.currentStage)?new c(this):new b(this),this.setViewClass(),this.view.search=new e(this.currentView),this.view.search.init(a),this.view.init(a),this.view.renderLevel({context:{navItems:this.model.getLevel_0(),isSelected:this.model.getSelected()},level:"level_0"}).then(function(){f.currentLevel=0,f.view.initScope(a),f.view.addEvents(),f.view.sequencer=new d(f.view.scope,f.currentStage),f.initViewEvents(a)}))},initViewEvents:function(a){var b=this;this.view.events.on("click:level_0:desktop",function(){var c=this,e=b.model.getLevel_1(c).slice(),f=e.findIndex(function(a){return"linklist"==a.variant});-1!==f&&e.splice(f,1),b.currentLevel=1,b.view.delightLevel_0(),b.view.renderFlyoutHeader(b.model.getPageOverviewLink(c)),b.view.renderLevel_1({level_1:e,teaser:b.model.getTeaser(c,b.currentLevel)}).then(function(){b.view.sequencer.animateIn[b.currentView].call(b.view.sequencer,"flyout"),b.view.initScope(a),b.view.sequencer=new d(b.view.scope,b.currentStage),b.view.sequencer.itemsRollIn(),b.view.state="is-open:"+c,"function"==typeof b.view.applyFlyoutBackground&&b.view.applyFlyoutBackground(b.model.getTeaser(c,b.currentLevel))})}),this.view.events.on("click:burger",function(){b.view.renderFlyoutHeader({rankLink:b.model.getRankLink({currentLevel:b.currentLevel})}),b.view.sequencer.animateIn[b.currentView].call(b.view.sequencer,"flyout"),b.view.backdropIn(),b.setScrollBehaviour()}),this.view.events.on("click:navitem:default",function(){var c=this.rel,d=this.id,e="level_"+(b.currentLevel+1);b.currentLevel++,b.view.renderFlyoutHeader({rankLink:b.model.getRankLink({rel:c,id:d,currentLevel:b.currentLevel}),pageOverviewLink:b.model.getPageOverviewLink(c)}),b.previousLink={rel:c,id:d};b.view.renderLevel({level:e,context:{navItems:b.model.getNextLevel(b.currentLevel,c,d),teaser:b.model.getTeaser(c,b.currentLevel),isSelected:function(){var a=b.model.getSelected();return 1==b.currentLevel&&void 0!==a.level_0&&a.level_0==d?a:2==b.currentLevel&&void 0!==a.level_1&&a.level_1==d&&a}()}}).then(function(){b.view.sequencer.sequences[e].addEventListener({animationName:b.view.sequencer.animationName[e].in,onAnimationStart:function(){b.view.sequencer.panelFadeOut("level_"+(b.currentLevel-1))},onAnimationEnd:function(){b.view.initScope(a),b.view.addEvents()}}),b.view.sequencer.animateIn[b.currentView].call(b.view.sequencer,e)})}),this.view.events.on("click:back",function(){b.view.sequencer.sequences["level_"+b.currentLevel].addEventListener({animationName:b.view.sequencer.animationName["level_"+b.currentLevel].out,onAnimationStart:function(){b.currentLevel--,b.view.sequencer.panelFadeIn("level_"+b.currentLevel),b.view.renderFlyoutHeader({rankLink:b.model.getRankLink({rel:b.previousLink.rel,id:b.previousLink.id,currentLevel:b.currentLevel}),pageOverviewLink:0<b.currentLevel?b.model.getPageOverviewLink(b.previousLink.rel):null})},onAnimationEnd:function(){b.view.resetDom(["level_"+(b.currentLevel+1)]),b.view.initScope(a),b.view.addEvents()}}),b.view.sequencer.animateOut[b.currentView].call(b.view.sequencer,"level_"+b.currentLevel)}),this.view.events.on("click:close:default",function(){b.view.sequencer.sequences.flyout.addEventListener({animationName:b.view.sequencer.animationName.flyout.out,onAnimationEnd:function(){b.view.resetDom(["level_1","level_2"]),b.view.sequencer.removeAnimation("level_0",["-is-fade-out"]),b.view.sequencer.removeAnimation("level_1",["-is-active","-is-fade-out"]),b.view.sequencer.removeAnimation("level_2",["-is-active"]),b.resetScrollBehaviour(),b.currentLevel=0}}),b.view.sequencer.animateOut[b.currentView].call(b.view.sequencer,"flyout"),b.view.backdropOut()}),this.view.events.on("click:close:desktop",function(){b.view.delightLevel_0(),b.view.sequencer.animateOut[b.currentView].call(b.view.sequencer,"flyout"),b.view.state="is-closed",b.currentLevel=0})},hasViewChanged:function(){return null===this.currentView||-1!==g.default.indexOf(this.currentStage)&&"desktop"==this.currentView||-1==g.default.indexOf(this.currentStage)&&"default"==this.currentView},resetScrollBehaviour:function(){document.documentElement.classList.remove("flyout-default"),document.documentElement.classList.remove("-is-active")},setScrollBehaviour:function(){document.documentElement.classList.add("flyout-default"),document.documentElement.classList.add("-is-active")},setViewClass:function(){document.querySelector(".o-header").classList.remove("-is-desktop"),document.querySelector(".o-header").classList.remove("-is-default"),document.querySelector(".o-header").classList.add("-is-"+this.currentView)}},{init:function(a){var b=new h;b.init(a)}}});